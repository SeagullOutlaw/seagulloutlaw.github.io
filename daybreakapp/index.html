<html>

<head>
    <title>DaybreakApp</title>

    <link rel="icon" type="image/x-icon" href="https://seagulloutlaw.github.io/daybreakapp/resources/favicon.ico">

    <style>
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: black;
        }

        .tab button {
            background-color: transparent;
            color: rgb(255, 255, 255);
            float: left;
            border: 1px solid #ccc;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
        }

        .tab button:hover {
            background-color: grey;
        }

        .tab button.active {
            background-color: rgb(83, 88, 88);
        }

        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: none;
            border-top: none;
            font-size: 20px;
        }

        .checkboxlist {
            line-height: 1.4;
            border: 1px solid #ccc;
        }

        .normalbutton {
            background-color: rgb(104, 98, 98);
            color: rgb(255, 255, 255);
            border: 1px solid #ccc;
            cursor: pointer;
            padding: 10px 14px;
            transition: 0.3s;
        }

        .generatebutton {
            background-color: rgb(104, 98, 98);
            color: rgb(255, 255, 255);
            border: 1px solid #ccc;
            cursor: pointer;
            padding: 20px 30px;
            transition: 0.3s;
            font-size: 25px;
        }

        .resultsection {
            line-height: 1.5;
        }

        .resultlabel {
            display: inline-block;
            font-size: 25px;
        }
    </style>
</head>

<body bgcolor="#000000" text="#ffffff">

    <!-- Variables -->

    <script>
        let survivorList = [];
        survivorList[0] = {
            name: "Nami Deng",
            perk: "Hard Times"
        };
        survivorList[1] = {
            name: "Adriana Penn",
            perk: "Self Control"
        };
        survivorList[2] = {
            name: "Eiji Inagaki",
            perk: "Old Camera"
        };
        survivorList[3] = {
            name: "Gabrielle Cole",
            perk: "Tracking Machine"
        };
        survivorList[4] = {
            name: "Arlo Flores",
            perk: "Healer's Touch"
        };
        survivorList[5] = {
            name: "Riley West",
            perk: "Cheap Thrill"
        };
        survivorList[6] = {
            name: "Iris Daley",
            perk: "Pot of Life"
        };
        survivorList[7] = {
            name: "Jun Inagaki",
            perk: "Tough"
        };
        survivorList[8] = {
            name: "Yara Valle",
            perk: "Second Wind"
        };
        survivorList[9] = {
            name: "Cora Madden",
            perk: "Investigative Eye"
        };
        survivorList[10] = {
            name: "Mamo Ikaika",
            perk: "Mamo's Bat"
        };
        survivorList[11] = {
            name: "Seoung Kwan",
            perk: "Spiritual Connection"
        };
        survivorList[12] = {
            name: "Jack Sato",
            perk: "Stealthy"
        };
        survivorList[13] = {
            name: "Chaoxing Lai",
            perk: "Xingxing's Mic"
        };
        survivorList[14] = {
            name: "Taylor Dalton",
            perk: "Good Teacher"
        };
        survivorList[15] = {
            name: "Dae-Jung Pak",
            perk: "Charm"
        };
        survivorList[16] = {
            name: "Yeona Jeung",
            perk: "Obsessed"
        };
        survivorList[17] = {
            name: "Kyle Wolfe",
            perk: "Bear Trap"
        };
        survivorList[18] = {
            name: "Serena Wolfe",
            perk: "Hunter's Instinct"
        };
        survivorList[19] = {
            name: "Yan Tian",
            perk: "Detection Machine"
        };
        survivorList[20] = {
            name: "Nathan Reyes",
            perk: "Wit's End"
        };
        survivorList[21] = {
            name: "Elizabeth Payne",
            perk: "Self Assurance"
        };
        survivorList[22] = {
            name: "Yvonne Kojo",
            perk: "Fight or Flight"
        };
        survivorList[23] = {
            name: "Becca Prescott",
            perk: "Sole Survivor"
        };
        survivorList[24] = {
            name: "Sarah Lindholm",
            perk: "Lone Wolf"
        };
        survivorList[25] = {
            name: "Lyndon Davenport",
            perk: "Rauhm"
        };
        survivorList[26] = {
            name: "Dakari Bowens",
            perk: "Heal Gun"
        };
        survivorList[27] = {
            name: "Saadiya Ali",
            perk: "Course Control"
        };
        survivorList[28] = {
            name: "Elijah Songaa",
            perk: "Breakthrough"
        };
        survivorList[29] = {
            name: "Eman Attia",
            perk: "Evanesce"
        };
        survivorList[30] = {
            name: "Aaaqil Che",
            perk: "Adaptability"
        };
        survivorList[31] = {
            name: "Yronica Ayala",
            perk: "Egocentric Leech"
        };
        survivorList[32] = {
            name: "Callum Gallagher",
            perk: "Team Spirit"
        };
        survivorList[33] = {
            name: "Emery Rivera",
            perk: "Disappearing Act"
        };
        survivorList[34] = {
            name: "Amari Taymiyyah",
            perk: "Vagrant's Trick"
        };
        survivorList[35] = {
            name: "Sanjana Dewan",
            perk: "Quiet Steps"
        };
        survivorList[36] = {
            name: "Kelvin Mars",
            perk: "Sonar Dart"
        };
        survivorList[37] = {
            name: "Gavin Prescott",
            perk: "Gavin's Pistol"
        };
        survivorList[38] = {
            name: "Parker Kaplan",
            perk: "Triple Mocktail"
        };
        survivorList[39] = {
            name: "Crosby Aldrich",
            perk: "Royal Rule"
        };
        survivorList[40] = {
            name: "Rayner Byrne",
            perk: "Rayner's Shield"
        };
        survivorList[41] = {
            name: "Serena 'Sera' Vera",
            perk: "Smooth Skating"
        };
        survivorList[42] = {
            name: "Dakota Nicole",
            perk: "Flame Sprayer"
        };
        survivorList[43] = {
            name: "Ryder Parikh",
            perk: "Detail Oriented"
        };
        survivorList[44] = {
            name: "Makoto Shizuka",
            perk: "Shortcut"
        };
        survivorList[45] = {
            name: "Crystal Kaur",
            perk: "Clear Quartz"
        };
        survivorList[46] = {
            name: "Emil Singh",
            perk: "Inspire"
        };

        let killerlist = [];
        killerlist[0] = {
            name: "The Slasher"
        };
        killerlist[1] = {
            name: "The Host"
        };
        killerlist[2] = {
            name: "The Ghost"
        };
        killerlist[3] = {
            name: "The Showstopper"
        };
        killerlist[4] = {
            name: "The Unforgotten"
        };
        killerlist[5] = {
            name: "The Werewolf"
        };
        killerlist[6] = {
            name: "The Idol"
        };
        killerlist[7] = {
            name: "The Android"
        };
        killerlist[8] = {
            name: "The Warden"
        };
        killerlist[9] = {
            name: "The Polluted"
        };
        killerlist[10] = {
            name: "The Stalker"
        };
        killerlist[11] = {
            name: "The Banshee"
        };
        killerlist[12] = {
            name: "The Principal"
        };
        killerlist[13] = {
            name: "The Janitor"
        };
        killerlist[14] = {
            name: "The Apostate"
        };
        killerlist[15] = {
            name: "The Watcher"
        };
        killerlist[16] = {
            name: "The Surgeon"
        };
        killerlist[17] = {
            name: "The Voidskulk"
        };
        killerlist[18] = {
            name: "The Empress"
        }


        if (localStorage.checkedSurvivors === null || localStorage.checkedSurvivors === undefined) {
            localStorage.checkedSurvivors = "";
        }
        if (localStorage.checkedKillers === null || localStorage.checkedKillers === undefined) {
            localStorage.checkedKillers = "";
        }
    </script>



    <h1>DaybreakApp</h1>

    <div class="tab">
        <button class="tablinks" onclick="openTab(event, 'Survivor Randomizer Tab')" id="SurvivorRandomizerTab">Survivor
            Randomizer</button>
        <button class="tablinks" onclick="openTab(event, 'Killer Randomizer Tab')" id="KillerRandomizerTab">Killer
            Randomizer</button>
    </div>

    <!-- Survivor Randomizer Tab -->

    <div id="Survivor Randomizer Tab" class="tabcontent">
        <h2>Survivor Randomizer</h2>
        This tool will give you a random perk you can use in your next game.<br>
        It will also give you a random character which you can use if you have the perk unlocked.<br>
        <br>

        Select all survivors you want to be part of the randomizer and then hit Generate!

        <br>

        (Tip: Use CTRL + F to search for a survivor or perk!)
        <br><br>

        <button class="normalbutton" onclick="ToggleAll('SurvivorList', true)">Activate all</button>
        <button class="normalbutton" onclick="ToggleAll('SurvivorList', false)">Deactivate all</button>
        <br><br>

        <section id="SurvivorList" class="checkboxlist">

        </section>

        <br>

        <button id="survivorGenerateButton" class="generatebutton" onclick="GetRandomSurvivor()">Generate!</button>

        <br><br>

        <section class="resultsection">
            <label id="generatedPerkLabel" class="resultlabel">Perk:</label><br>
            <label id="generatedCharacterLabel" class="resultlabel">Character:</label>
        </section>

        <br>



    </div>


    <!-- Killer Randomizer Tab -->

    <div id="Killer Randomizer Tab" class="tabcontent">
        <h2>Killer Randomizer</h2>
        This tool will give you a random killer you can use in your next game.<br>
        <br>

        Select all killers you want to be part of the randomizer and then hit Generate!

        <br>

        (Tip: Use CTRL + F to search for a killer!)
        <br><br>

        <button class="normalbutton" onclick="ToggleAll('KillerList', true)">Activate all</button>
        <button class="normalbutton" onclick="ToggleAll('KillerList', false)">Deactivate all</button>
        <br><br>

        <section id="KillerList" class="checkboxlist">

        </section>

        <br>

        <button id="killerGenerateButton" class="generatebutton" onclick="GetRandomKiller()">Generate!</button>

        <br><br>

        <section class="resultsection">
            <label id="generatedKillerLabel" class="resultlabel">Killer:</label>
        </section>

    </div>

    <button class="normalbutton" style="float: right" onclick="ResetData()">Reset Data</button>

    <!-- Randomizer Functions -->

    <script>
        function GetRandomSurvivor() {
            let survivorListElement = document.getElementById("SurvivorList");
            let perkLabel = document.getElementById("generatedPerkLabel");
            let characterLabel = document.getElementById("generatedCharacterLabel");
            let survivorGenerateButton = document.getElementById("survivorGenerateButton");

            let randomperkpool = []
            let randomcharacterpool = []

            for (i = 0; i < survivorListElement.children.length; i++) {
                let element = survivorListElement.children[i];
                if (element.type == "checkbox") {
                    if (element.checked == true) {
                        let perk = FindSurvivorInList("name", element.name).perk;
                        let addon = "'s";

                        if (element.name.charAt(element.name.length - 1) == 's') {
                            addon = "'";
                        }

                        randomperkpool.push(perk + " (" + element.name + addon + " perk)");
                        randomcharacterpool.push(element.name);
                    }
                }
            }

            if (randomperkpool.length == 0) {
                alert("You need to select at least one survivor!");
            } else {

                let randomperk = randomperkpool[Math.floor(Math.random() * randomperkpool.length)];
                let randomcharacter = randomcharacterpool[Math.floor(Math.random() * randomcharacterpool.length)];


                perkLabel.innerHTML = "Perk: " + randomperk;
                characterLabel.innerHTML = "Character: " + randomcharacter;
            }
        }

        function GetRandomKiller() {
            let killerListElement = document.getElementById("KillerList");
            let characterLabel = document.getElementById("generatedKillerLabel");
            let randomcharacterpool = []

            for (i = 0; i < killerListElement.children.length; i++) {
                let element = killerListElement.children[i];
                if (element.type == "checkbox") {
                    if (element.checked == true) {
                        randomcharacterpool.push(element.name);
                    }
                }
            }

            if (randomcharacterpool.length == 0) {
                alert("You need to select at least one killer!");
            } else {
                let randomcharacter = randomcharacterpool[Math.floor(Math.random() * randomcharacterpool.length)];

                characterLabel.innerHTML = "Killer: " + randomcharacter;
            }
        }

    </script>

    <!-- Website Functions -->

    <script>
        function openTab(event, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            tablinks = document.getElementsByClassName("tablinks");

            for (i = 0; i < tablinks.length; i++) {
                tabcontent[i].style.display = "none";
            }

            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            document.getElementById(tabName).style.display = "block";
            event.currentTarget.className += " active";
        }

        function ToggleAll(list, change) {
            let listElement = document.getElementById(list);
            let type = ""

            if (list === "SurvivorList") {
                type = "Survivor";
            } else if (list === "KillerList") {
                type = "Killer";
            }

            for (index = 0; index < listElement.children.length; index++) {
                let element = listElement.children[index];

                if (element.type == "checkbox") {
                    element.checked = change;
                    SaveCheckboxOption(element.name, type);
                }

            }

        }


        function FindSurvivorInList(key, value) {
            for (i = 0; i < survivorList.length; i++) {
                let survivor = survivorList[i];

                if (survivor[key] === value) {
                    return survivor
                }
            }
        }

        function FindKillerInList(key, value) {
            for (i = 0; i < killerlist.length; i++) {
                let killer = killerlist[i];

                if (killer[key] === value) {
                    return killer
                }
            }
        }

        function CheckIfSaved(saveString, id) {
            let split = saveString.split(',')

            if (split.length > 0 && !split[0] == "") {
                for (i = 0; i < split.length; i++) {
                    let value = split[i];

                    if (value === id) {
                        return true;
                    }
                }
            }


            return false;
        }

        function SaveCheckboxOption(name, type) {

            let array = []
            let savedstring = "";
            let listEntry = {};

            if (type === "Survivor") {
                savedstring = localStorage.checkedSurvivors;
                listEntry = FindSurvivorInList("name", name);
            } else if (type === "Killer") {
                savedstring = localStorage.checkedKillers;

                listEntry = FindKillerInList("name", name);
            }

            let checkbox = document.getElementById(type + "_" + listEntry.id.toString() + "_Checkbox")
            if (savedstring === "") {
                array = []
            } else {
                array = savedstring.split(',');
            }



            let i = 0;
            while (i < array.length) {
                if (array[i] === listEntry.id.toString()) {
                    array.splice(i, 1);
                } else {
                    i++;
                }
            }


            if (checkbox.checked === true) {
                array.push(listEntry.id);
            }

            savedstring = array.toString();

            if (type === "Survivor") {
                localStorage.setItem("checkedSurvivors", savedstring);
            } else if (type === "Killer") {
                localStorage.setItem("checkedKillers", savedstring);
            }


        }

        function ResetData() {
            if (confirm("Are you sure you want to reset your data?") == true) {
                localStorage.checkedSurvivors = "";
                localStorage.checkedKillers = "";

                alert("Data reset!");
            }

            
        }

        function AddIDsToCollection() {
            for (index = 0; index < survivorList.length; index++) {
                survivorList[index].id = index;
            }
            for (index = 0; index < killerlist.length; index++) {
                killerlist[index].id = index;
            }
        }

        function ConvertOldSaveData() {
            if (!localStorage.didNameToIdConversion === true) {
                let changed = false;

                let oldSurvivorList = localStorage.checkedSurvivors.toString()
                let oldKillerList = localStorage.checkedKillers.toString()

                let survivorNames = [];
                let killerNames = [];

                //     for (index = 0; index < survivorList.length; index++) {
                //         let survivor = survivorList[index];
                //          survivorNames.push(survivor.name);
                //     }
                //      for (index = 0; index < killerlist.length; index++) {
                //          let killer = killerlist[index];
                //         killerNames.push(killer.name);
                //    }

                for (index = 0; index < survivorList.length; index++) {
                    let survivor = survivorList[index];
                    localStorage.checkedSurvivors = localStorage.checkedSurvivors.replace(survivor.name, survivor.id.toString())
                }

                for (index = 0; index < killerlist.length; index++) {
                    let killer = killerlist[index];
                    localStorage.checkedKillers = localStorage.checkedKillers.replace(killer.name, killer.id.toString())
                }


                localStorage.didNameToIdConversion = true;
            }




        }

    </script>

    <!-- Load data and fill in variables -->
    <script>
        let survivorTab = document.getElementById("SurvivorList")
        let killerTab = document.getElementById("KillerList")

        AddIDsToCollection()

        ConvertOldSaveData()

        for (index = 0; index < survivorList.length; index++) {
            let survivor = survivorList[index];
            let checkbox = document.createElement("input");

            checkbox.setAttribute("type", "checkbox");
            checkbox.setAttribute("id", "Survivor_" + index.toString() + "_Checkbox");

            checkbox.setAttribute("name", survivor.name);
            checkbox.setAttribute("value", survivor.name);

            checkbox.addEventListener("change", function () {
                SaveCheckboxOption(survivor.name, "Survivor");
            }, false);

            let label = document.createElement("label");
            label.setAttribute("for", survivor.name);
            label.innerHTML = survivor.name + " (" + survivor.perk + ")" + "<br>";

            if (CheckIfSaved(localStorage.checkedSurvivors, index.toString())) {
                checkbox.checked = true;
            }


            survivorTab.appendChild(checkbox);
            survivorTab.appendChild(label);
        }

        for (index = 0; index < killerlist.length; index++) {
            let killer = killerlist[index];

            let checkbox = document.createElement("input");
            checkbox.setAttribute("type", "checkbox");
            checkbox.setAttribute("id", "Killer_" + index.toString() + "_Checkbox");
            checkbox.setAttribute("name", killer.name);
            checkbox.setAttribute("value", killer.name);

            checkbox.addEventListener("change", function () {
                SaveCheckboxOption(killer.name, "Killer");
            }, false);

            let label = document.createElement("label");
            label.setAttribute("for", killer.name);
            label.innerHTML = killer.name + "<br>";


            if (CheckIfSaved(localStorage.checkedKillers, index.toString())) {
                checkbox.checked = true;
            }

            killerTab.appendChild(checkbox);
            killerTab.appendChild(label);
        }

    </script>


    <!-- Open default tab -->
    <script>
        document.getElementById("SurvivorRandomizerTab").click();
    </script>

</body>

</html>
